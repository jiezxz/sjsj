(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-185d3ebc","chunk-3187c104"],{"0d63":function(e,t,c){"use strict";c.r(t);var l=c("7a23"),a=function(e){return Object(l["pushScopeId"])("data-v-0463adc6"),e=e(),Object(l["popScopeId"])(),e},n={class:"vol-dialog"},o=a((function(){return Object(l["createElementVNode"])("i",{class:"el-icon el-icon-full-screen"},null,-1)})),r=[o],i={key:0,class:"dia-footer"},u=a((function(){return Object(l["createElementVNode"])("i",{class:"el-icon-close"},null,-1)})),d=Object(l["createTextVNode"])("关闭");function s(e,t,c,a,o,s){var b=Object(l["resolveComponent"])("el-scrollbar"),m=Object(l["resolveComponent"])("el-button"),j=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",n,[Object(l["createVNode"])(j,{modelValue:e.vmodel,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.vmodel=t}),"close-on-click-modal":!1,"close-on-press-escape":!1,width:e.width,fullscreen:e.fullscreen,draggable:e.draggable,modal:e.modal,"before-close":e.handleClose},{header:Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("i",{class:Object(l["normalizeClass"])(e.icon)},null,2),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.title)+" ",1),Object(l["createElementVNode"])("button",{class:"el-dialog__headerbtn",type:"button",style:{right:"35px",color:"var(--el-color-info)"},onClick:t[0]||(t[0]=function(){return e.handleFullScreen&&e.handleFullScreen.apply(e,arguments)})},r)]})),footer:Object(l["withCtx"])((function(){return[e.footer?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",i,[Object(l["renderSlot"])(e.$slots,"footer",{},void 0,!0),e.footer?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createBlock"])(m,{key:0,type:"primary",size:"mini",onClick:t[1]||(t[1]=function(t){return e.handleClose()})},{default:Object(l["withCtx"])((function(){return[u,d]})),_:1}))])):Object(l["createCommentVNode"])("",!0)]})),default:Object(l["withCtx"])((function(){return[Object(l["createVNode"])(b,{"max-height":e.contentHeight},{default:Object(l["withCtx"])((function(){return[e.inited?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:0,style:Object(l["normalizeStyle"])([{"min-height":"50px"},{padding:e.padding+"px"}]),class:"srcoll-content"},[Object(l["renderSlot"])(e.$slots,"content",{},void 0,!0),Object(l["renderSlot"])(e.$slots,"default",{},void 0,!0)],4)):Object(l["createCommentVNode"])("",!0)]})),_:3},8,["max-height"])]})),_:3},8,["modelValue","width","fullscreen","draggable","modal","before-close"])])}c("a9e3");var b=Object(l["defineComponent"])({props:{modelValue:!1,lazy:{type:Boolean,default:!1},icon:{type:String,default:"el-icon-warning-outline"},title:{type:String,default:"基本信息"},height:{type:Number,default:200},width:{type:Number,default:650},padding:{type:Number,default:16},modal:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},mask:{type:Boolean,default:!0},onModelClose:{type:Function,default:function(e){return!0}},footer:{type:Boolean,default:!0}},setup:function(e,t){var c=.95*document.body.clientHeight-60,a=Object(l["ref"])(!0),n=Object(l["ref"])(!1),o=Object(l["ref"])(!1),r=Object(l["ref"])(100);n.value=e.modelValue,o.value=!!t.slots.footer;var i=Object(l["ref"])(200);i.value=e.height;var u=function(c,l){var a=e.onModelClose(!!l);!1!==a&&(n.value=!1,t.emit("update:modelValue",!1),c&&c())},d=function(e){return i.value=c-30,c/-2+"px"};r.value=d(),Object(l["watch"])((function(){return e.modelValue}),(function(e,t){n.value=e})),Object(l["watch"])((function(){return e.height}),(function(e,t){r.value=d()}));var s=Object(l["ref"])(!1),b=function(){s.value=!s.value,t.emit("fullscreen",s.value)};return{handleClose:u,inited:a,vmodel:n,footer:o,top:r,calcHeight:d,contentHeight:i,fullscreen:s,handleFullScreen:b}}}),m=(c("19bb"),c("a80f"),c("6b0d")),j=c.n(m);const O=j()(b,[["render",s],["__scopeId","data-v-0463adc6"]]);t["default"]=O},"19bb":function(e,t,c){"use strict";c("9d79")},"9cb5":function(e,t,c){},"9d79":function(e,t,c){},a80f:function(e,t,c){"use strict";c("f3c5")},dde2:function(e,t,c){"use strict";c("9cb5")},e73a:function(e,t,c){"use strict";c.r(t);c("b0c0");var l=c("7a23"),a=function(e){return Object(l["pushScopeId"])("data-v-13376f56"),e=e(),Object(l["popScopeId"])(),e},n={class:"cell-item"},o=Object(l["createTextVNode"])("审核"),r=Object(l["createTextVNode"])("审核记录"),i={class:"audit-content"},u={key:0,class:"fx-left"},d={class:"v-steps"},s={class:"left-item"},b=a((function(){return Object(l["createElementVNode"])("div",null,"流程开始",-1)})),m={class:"left-date"},j={class:"right-item"},O=a((function(){return Object(l["createElementVNode"])("div",{class:"step-line"},null,-1)})),p=a((function(){return Object(l["createElementVNode"])("i",{class:"step-circle"},null,-1)})),f={class:"step-title"},v={class:"step-text"},h={key:1,class:"step-item"},g=a((function(){return Object(l["createElementVNode"])("div",{class:"left-item"},[Object(l["createElementVNode"])("div",null,"流程结束")],-1)})),V={class:"right-item"},y=a((function(){return Object(l["createElementVNode"])("div",{class:"step-line"},null,-1)})),k=a((function(){return Object(l["createElementVNode"])("i",{class:"step-circle"},null,-1)})),N={class:"step-title"},w={class:"left-item"},C=a((function(){return Object(l["createElementVNode"])("div",null,"审批时间",-1)})),E={class:"left-date"},x={class:"right-item"},S=a((function(){return Object(l["createElementVNode"])("div",{class:"step-line"},null,-1)})),B=a((function(){return Object(l["createElementVNode"])("i",{class:"step-circle"},null,-1)})),D={class:"step-title"},_={class:"step-text"},F={class:"step-text"},z={class:"step-text"},T={key:0},$={class:"rd"},I=a((function(){return Object(l["createElementVNode"])("span",null,"审批：",-1)})),U={class:"btn"},A=Object(l["createTextVNode"])("审批");function L(e,t,c,a,L,P){var H=Object(l["resolveComponent"])("el-descriptions-item"),R=Object(l["resolveComponent"])("el-descriptions"),W=Object(l["resolveComponent"])("el-radio"),J=Object(l["resolveComponent"])("el-radio-group"),M=Object(l["resolveComponent"])("el-alert"),K=Object(l["resolveComponent"])("el-input"),q=Object(l["resolveComponent"])("el-button"),G=Object(l["resolveComponent"])("vol-table"),Q=Object(l["resolveComponent"])("vol-box");return Object(l["openBlock"])(),Object(l["createBlock"])(Q,{footer:!1,modelValue:e.model,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.model=t}),height:e.height,width:e.width,padding:0,lazy:!0,title:"审核"},{default:Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("div",{class:"audit-model-content",style:Object(l["normalizeStyle"])({height:e.height-100+"px"})},[Object(l["createVNode"])(R,{class:"desc-top",column:3,size:"default",border:!0},{default:Object(l["withCtx"])((function(){return[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.formData,(function(e,t){return Object(l["openBlock"])(),Object(l["createBlock"])(H,{key:t},{label:Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("div",n,Object(l["toDisplayString"])(e.name),1)]})),default:Object(l["withCtx"])((function(){return[Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.value),1)]})),_:2},1024)})),128))]})),_:1}),Object(l["withDirectives"])(Object(l["createVNode"])(J,{style:{"padding-left":"15px"},modelValue:e.activeName,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.activeName=t}),class:"ml-4"},{default:Object(l["withCtx"])((function(){return[Object(l["createVNode"])(W,{label:"audit",size:"large"},{default:Object(l["withCtx"])((function(){return[o]})),_:1}),Object(l["createVNode"])(W,{label:"log",size:"large"},{default:Object(l["withCtx"])((function(){return[r]})),_:1})]})),_:1},8,["modelValue"]),[[l["vShow"],e.hasFlow]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",i,[e.hasFlow?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",u,[Object(l["createElementVNode"])("div",d,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.workFlowSteps,(function(t,c){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:c},["start"==t.stepAttrType?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:0,class:Object(l["normalizeClass"])(["step-item",{"step-item-ad":t.auditId||"start"==t.stepAttrType}])},[Object(l["createElementVNode"])("div",s,[b,Object(l["createElementVNode"])("div",m,Object(l["toDisplayString"])(t.createDate),1)]),Object(l["createElementVNode"])("div",j,[O,p,Object(l["createElementVNode"])("div",f,Object(l["toDisplayString"])(t.stepName),1),Object(l["createElementVNode"])("div",v,"发起人："+Object(l["toDisplayString"])(t.creator),1)])],2)):"end"==t.stepAttrType?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",h,[g,Object(l["createElementVNode"])("div",V,[y,k,Object(l["createElementVNode"])("div",N,Object(l["toDisplayString"])(t.stepName),1)])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:2,class:Object(l["normalizeClass"])([{"step-current":t.isCurrent},"step-item"])},[Object(l["createElementVNode"])("div",w,[C,Object(l["createElementVNode"])("div",E,Object(l["toDisplayString"])(t.auditDate||"待审批"),1)]),Object(l["createElementVNode"])("div",x,[S,B,Object(l["createElementVNode"])("div",D,Object(l["toDisplayString"])(t.stepName),1),Object(l["createElementVNode"])("div",_,"审批人："+Object(l["toDisplayString"])(t.auditor),1),Object(l["createElementVNode"])("div",F," 状 态： "+Object(l["toDisplayString"])(e.getAuditStatus(t.auditStatus)),1),Object(l["createElementVNode"])("div",z,"备 注： "+Object(l["toDisplayString"])(t.remark||"-"),1)])],2))])})),128))])])):Object(l["createCommentVNode"])("",!0),e.isCurrentUser||!e.hasFlow?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:1,class:"fx-right",style:Object(l["normalizeStyle"])({width:e.hasFlow?"400px":"100%"})},[e.hasFlow?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",T,[Object(l["createVNode"])(M,{title:"当前选中【"+e.rowLen+"】条记录待审核..",type:"success",closable:!1},null,8,["title"])])),Object(l["createElementVNode"])("div",$,[I,Object(l["createVNode"])(J,{style:{"margin-left":"15px"},modelValue:e.auditParam.value,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.auditParam.value=t})},{default:Object(l["withCtx"])((function(){return[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.auditParam.data,(function(e){return Object(l["openBlock"])(),Object(l["createBlock"])(W,{key:e.value,label:e.value},{default:Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.text),1)]})),_:2},1032,["label"])})),128))]})),_:1},8,["modelValue"])]),Object(l["createVNode"])(K,{style:{"padding-top":"10px"},modelValue:e.auditParam.reason,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.auditParam.reason=t}),type:"textarea",autosize:{minRows:4,maxRows:10},placeholder:"请输入备注..."},null,8,["modelValue"]),Object(l["createElementVNode"])("div",U,[Object(l["createVNode"])(q,{type:"primary",onClick:e.auditClick,icon:"Check"},{default:Object(l["withCtx"])((function(){return[A]})),_:1},8,["onClick"])])],4)):Object(l["createCommentVNode"])("",!0)],512),[[l["vShow"],"audit"==e.activeName||!e.hasFlow]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(G,{tableData:e.tableData,columns:e.columns,height:e.height-250,"pagination-hide":!0,"load-key":!1,"text-inline":!1,ck:!1},null,8,["tableData","columns","height"])],512),[[l["vShow"],"log"==e.activeName]])],4)]})),_:1},8,["modelValue","height","width"])}var P=c("2909"),H=(c("7db0"),c("d81d"),c("b64b"),c("159b"),c("99af"),c("ac1f"),c("841c"),c("0b13")),R=c("0d63"),W=c("c1fb"),J=Object(l["defineComponent"])({components:{VolTable:H["a"],VolBox:R["default"]},props:{option:{type:Object,default:{key:"",cnName:"",name:"",url:""}}},setup:function(e,t){var c=t.emit,a=Object(l["ref"])(500),n=Object(l["ref"])(820),o=Object(l["ref"])(!1),r=Object(l["reactive"])([]),i=Object(l["ref"])(!1),u=Object(l["reactive"])([]),d=Object(l["reactive"])({rows:0,model:!1,value:-1,reason:"",data:[]}),s=Object(l["getCurrentInstance"])(),b=s.proxy;d.data=b.$global.audit.data;var m=Object(l["reactive"])([]),j=Object(l["reactive"])([{title:"节点",field:"stepName",width:100},{title:"审批人",field:"auditor",width:80},{title:"审批结果",field:"auditStatus",width:70,bind:{data:[]}},{title:"审批时间",field:"auditDate",width:145},{title:"备注",field:"remark",width:120}]),O=Object(l["ref"])(null),p=Object(l["ref"])("audit"),f=Object(l["reactive"])([]),v=function(e){return(f.find((function(t){return t.key===e+""}))||{value:e}).value},h=Object(l["ref"])(0),g=[],V=function(e){var t=e.table,c="api/Sys_WorkFlow/getSteps?tableName=".concat(t),l=g.map((function(t){return t[e.key]}));W["a"].post(c,l,!0).then((function(e){if(e.status){if(i.value=!!(e.list||[]).length,!i.value){var t=Object.keys(g[0]).find((function(e){return"auditstatus"===e.toLowerCase()})),c=g.every((function(e){return b.$global.audit.status.some((function(c){return c===e[t]||!e[t]}))}));return c?(h.value=g.length,o.value=!0,n.value=430,a.value=350,void(O.value=!0)):void b.$message.error("只能选择待审批或审核中的数据")}o.value=!0,a.value=.95*document.body.clientHeight,n.value=820,f.length||(f.push.apply(f,Object(P["a"])(e.auditDic||[])),j.forEach((function(e){"auditStatus"==e.field&&(e.bind.data=f)}))),O.value=e.list.some((function(e){return e.isCurrentUser})),r.length=0,r.push.apply(r,Object(P["a"])(e.list)),m.length=0,m.push.apply(m,Object(P["a"])(e.log)),u.length=0,u.push.apply(u,Object(P["a"])(e.form||[]))}else b.$message.error(e.message)}))},y=function(){if(-1!=d.value)if(k.value){var e=g.map((function(e){return e[N.key]})),t="api/".concat(N.table,"/audit?auditReason=").concat(d.reason,"&auditStatus=").concat(d.value);W["a"].post(t,e,"审核中....").then((function(e){e.status?(o.value=!1,b.$parent.search(),b.$message.success(e.message)):b.$message.error(e.message)}))}else c("auditClick",d,g,(function(e){e.status&&(o.value=!1,m.length=0)}));else b.$message.error("请选择审批项")},k=Object(l["ref"])(!1),N={},w=function(t,c){k.value=!!c,g=t,p.value="audit",d.reason="",d.value=-1,N=c?{table:t[0].WorkTable,key:"WorkTableKey"}:{table:e.option.url.replaceAll("/",""),key:e.option.key},V(N)};return{columns:j,height:a,width:n,model:o,workFlowSteps:r,getAuditInfo:V,getAuditStatus:v,activeName:p,reactive:l["reactive"],tableData:m,auditParam:d,auditClick:y,open:w,isCurrentUser:O,hasFlow:i,rowLen:h,formData:u,isFlow:k}}}),M=(c("dde2"),c("6b0d")),K=c.n(M);const q=K()(J,[["render",L],["__scopeId","data-v-13376f56"]]);t["default"]=q},f3c5:function(e,t,c){}}]);