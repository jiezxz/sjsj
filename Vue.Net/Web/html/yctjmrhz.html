<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>异常停机每日汇总</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">


    <style>
    </style>
</head>
<link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css"
      rel="stylesheet">

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.22.0/moment-with-locales.js"></script>
<script src="https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>



<script src="js/tableExport.jquery.plugin-master//libs/FileSaver/FileSaver.min.js"></script>
<script src="js/tableExport.jquery.plugin-master//libs/js-xlsx/xlsx.core.min.js"></script>
<script src="js/tableExport.jquery.plugin-master//tableExport.min.js"></script>

<body ontouchstart="" class="page-bg">
    <div class="container" style="width: 100%;">
        <h2 class="text-center">异常停机每日汇总</h2>
        <br />
        <div class="row">
            <div class="col-md-3">
                <div class="form-group">
                    <label class="col-md-3 " style="line-height: 35px;">年月</label>
                    <div class='input-group date' id='datetimepicker1'>
                        <input type='text' class="form-control" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <button type="button" class="btn btn-primary" id="select">查询</button>
            </div>
            <div class="col-md-6">
                <button type="button" class="btn btn-secondary" id="export" style="float:right">导出</button>
            </div>
        </div>

        <div class="row">

            <table class="table " id="tables">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">日期</th>
                        <th scope="col">线别</th>
                        <th scope="col">班次</th>
                        <th scope="col">正常生产时长</th>
                        <th scope="col">停机时长</th>
                        <th scope="col">清洁时长</th>
                        <th scope="col">穿膜时长</th>
                        <th scope="col">提速时长</th>
                        <th scope="col">调试时长</th>
                        <th scope="col">设备维修时间</th>
                        <th scope="col">分类</th>
                        <th scope="col"> 异常时间>2H</th>
                        <th scope="col" class=" col-md-2">参与人员</th>
                    </tr>
                </thead>
                <tbody id="tbody">
                  
                    
                </tbody>
            </table>

        </div>

    </div>
    <script>
        $('#datetimepicker1').datetimepicker({
            format: 'YYYY-MM',
            locale: moment.locale('zh-cn'),
            defaultDate: new Date
        });

        $(function () {
            $('#datetimepicker1').datetimepicker({
                format: 'YYYY-MM',
                locale: moment.locale('zh-cn')
            });

            $("#export").click(function () {
                $("#tables").tableExport({
                    type: "xlsx",
                    escape: "false",
                });
            });

            $("#select").click(function () {
                $("#tbody").html("");
                var params = { "riQi": $('#datetimepicker1').find("input").val()};
                $.ajax({
                   url: "http://172.21.56.96:9099/api/dataCollection_tjyc/yctjmrhz",
                   // url: "http://localhost:9991/api/dataCollection_tjyc/yctjmrhz",
                    type: 'POST',
                    data: JSON.stringify(params),
                    contentType: 'application/json',
                    dateType: 'json',
                    success: function (result) {

                        if (result.length > 0) {
                          
                            $.each(result, function (i, item) {
                                var html = " <tr>";

                                $.each(item, function (j, value) {
                            
                                    html += "   <td>" + (value ? value:"") + "</td>";
                                })

                                html += "</tr>";
                                $("#tbody").append(html)
                            })

                        
                            
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        if (XMLHttpRequest.status == 401 || XMLHttpRequest.status == 402) {

                        }
                    }

                });

            });


            $("#select").click();
        });
    </script>


</body>

</html>